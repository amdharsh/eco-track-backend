<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoTrack - Carbon Footprint Tracker</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #10b981;
            --primary-dark: #059669;
            --secondary-color: #3b82f6;
            --accent-color: #f59e0b;
            --danger-color: #ef4444;
            --text-main: #1f2937;
            --text-secondary: #6b7280;
            --bg-body: #f3f4f6;
            --bg-card: #ffffff;
            --border-color: #e5e7eb;
            --radius-md: 12px;
            --radius-lg: 16px;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --chat-width: 350px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            display: flex;
            min-height: 100vh;
        }

        /* --- Sidebar --- */
        .sidebar {
            width: 260px;
            background-color: var(--bg-card);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            position: fixed;
            height: 100%;
            z-index: 10;
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 2rem;
        }

        .nav-group-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin: 1.5rem 0 0.5rem 10px;
            font-weight: 600;
        }

        .nav-links { list-style: none; display: flex; flex-direction: column; gap: 0.2rem; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 16px;
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.95rem;
        }

        .nav-item:hover { background-color: #f0fdf4; color: var(--primary-color); }
        .nav-item.active { background-color: #ecfdf5; color: var(--primary-dark); font-weight: 600; }
        
        /* Submenu for settings */
        .submenu {
            display: none;
            flex-direction: column;
            margin-left: 36px;
            gap: 4px;
            border-left: 2px solid var(--border-color);
        }
        .submenu.open { display: flex; }
        .submenu .nav-item { font-size: 0.85rem; padding: 8px 12px; }
        .submenu .nav-item.active { border-left: 2px solid var(--primary-color); }

        /* --- Main Content --- */
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 2rem;
            max-width: 1400px;
            position: relative;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .page-title h1 { font-size: 1.75rem; color: var(--text-main); }
        .page-title p { color: var(--text-secondary); font-size: 0.9rem; margin-top: 4px; }

        .user-profile { display: flex; align-items: center; gap: 12px; cursor: pointer; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }

        /* --- Sections --- */
        .section { display: none; animation: fadeIn 0.3s ease-in-out; }
        .section.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Cards --- */
        .card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }

        /* --- Pay Bills Page --- */
        .bills-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        .bill-form-group { margin-bottom: 1rem; }
        .bill-form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; font-size: 0.9rem; }
        .bill-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        .bill-input:focus { outline: none; border-color: var(--primary-color); }
        
        .pay-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }
        .pay-btn:hover { background-color: var(--primary-dark); }

        .bill-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 10px;
        }

        /* --- Chatbot --- */
        .chat-toggle-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-md);
            cursor: pointer;
            z-index: 1000;
            font-size: 1.5rem;
            transition: transform 0.2s;
        }
        .chat-toggle-btn:hover { transform: scale(1.05); }

        .chat-container {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: var(--chat-width);
            height: 500px;
            background-color: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            z-index: 999;
            transform: scale(0);
            transform-origin: bottom right;
            transition: transform 0.3s ease;
        }
        .chat-container.open { transform: scale(1); }

        .chat-header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .chat-body { flex: 1; padding: 15px; overflow-y: auto; background: #f9fafb; display: flex; flex-direction: column; gap: 10px; }
        
        .chat-msg { max-width: 80%; padding: 10px 14px; border-radius: 12px; font-size: 0.9rem; line-height: 1.4; }
        .chat-msg.bot { background-color: #e5e7eb; align-self: flex-start; border-bottom-left-radius: 2px; }
        .chat-msg.user { background-color: var(--primary-color); color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

        .chat-input-area {
            padding: 10px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 8px;
        }
        .chat-input {
            flex: 1;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            outline: none;
        }

        /* --- Settings Sections --- */
        .settings-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--primary-color); }
        input:checked + .slider:before { transform: translateX(20px); }

        /* --- Utils --- */
        .text-danger { color: var(--danger-color); }
        .menu-toggle { display: none; font-size: 1.5rem; cursor: pointer; color: var(--text-main); margin-right: 1rem; }
        
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); width: 240px; }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 1rem; }
            .menu-toggle { display: block; }
            .bills-layout { grid-template-columns: 1fr; }
            .chat-container { width: 90%; right: 5%; bottom: 90px; }
        }
    </style>
</head>
<body>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="brand">
            <i class="fa-solid fa-leaf"></i> EcoTrack
        </div>
        
        <ul class="nav-links">
            <li class="nav-item active" onclick="switchTab('dashboard')">
                <i class="fa-solid fa-grid-2"></i> Dashboard
            </li>
            <li class="nav-item" onclick="switchTab('transactions')">
                <i class="fa-solid fa-receipt"></i> Transactions
            </li>
            <li class="nav-item" onclick="switchTab('pay-bills')">
                <i class="fa-solid fa-credit-card"></i> Pay Bills
            </li>
            <li class="nav-item" onclick="switchTab('insights')">
                <i class="fa-solid fa-chart-pie"></i> Insights
            </li>
            <li class="nav-item" onclick="switchTab('recommendations')">
                <i class="fa-solid fa-lightbulb"></i> Recommendations
            </li>
        </ul>

        <div class="nav-group-label">Account</div>
        <ul class="nav-links">
            <li class="nav-item" onclick="toggleSettingsMenu()">
                <i class="fa-solid fa-gear"></i> Settings <i class="fa-solid fa-chevron-down" style="margin-left: auto; font-size: 0.7rem;" id="settings-arrow"></i>
            </li>
            <ul class="submenu" id="settings-submenu">
                <li class="nav-item" onclick="switchTab('settings-info')">Your Info</li>
                <li class="nav-item" onclick="switchTab('settings-notifications')">Notifications</li>
                <li class="nav-item" onclick="switchTab('settings-privacy')">Privacy & Security</li>
                <li class="nav-item" onclick="switchTab('settings-about')">About</li>
                <li class="nav-item" onclick="switchTab('settings-help')">Help & Feedback</li>
                <li class="nav-item text-danger" onclick="alert('Signed out successfully.')">Sign Out</li>
            </ul>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <header>
            <div style="display: flex; align-items: center;">
                <div class="menu-toggle" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></div>
                <div class="page-title">
                    <h1 id="page-header">Dashboard</h1>
                    <p id="page-subtitle">Welcome back! Here's your eco-update.</p>
                </div>
            </div>
            <div class="user-profile" onclick="toggleSettingsMenu()">
                <div style="text-align: right; display: none; @media(min-width: 600px){display:block;}">
                    <div style="font-weight: 600;">Alex Johnson</div>
                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Eco Warrior</div>
                </div>
                <img src="https://picsum.photos/seed/ecoUser/100/100" alt="Profile" class="avatar">
            </div>
        </header>

        <!-- 1. DASHBOARD (Summary View) -->
        <section id="dashboard" class="section active">
            <div class="card">
                <h3 style="margin-bottom: 1rem;">Monthly Overview</h3>
                <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
                    <div>
                        <div style="font-size: 2rem; font-weight: 700;">204.26</div>
                        <div style="color: var(--text-secondary);">kg CO₂e Total</div>
                    </div>
                    <div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">22%</div>
                        <div style="color: var(--text-secondary);">Better than Avg</div>
                    </div>
                </div>
            </div>
            <!-- Reusing generic card for dashboard simplicity -->
            <div class="card">
                <p><i class="fa-solid fa-lightbulb" style="color: var(--accent-color);"></i> <strong>Tip:</strong> Switch to green energy to save 0.10 kg CO₂e.</p>
            </div>
        </section>

        <!-- 2. TRANSACTIONS -->
        <section id="transactions" class="section">
            <div class="card">
                <h3>Recent Transactions</h3>
                <table style="width:100%; border-collapse:collapse; margin-top:1rem;">
                    <tr style="text-align:left; color:var(--text-secondary); border-bottom:1px solid #eee;">
                        <th style="padding:10px;">Merchant</th>
                        <th>Category</th>
                        <th>Amount</th>
                        <th>CO₂e</th>
                    </tr>
                    <!-- Sample Data -->
                    <tr><td style="padding:10px;">United Airlines</td><td>Travel</td><td>$450.00</td><td style="color:var(--danger-color);">189.00 kg</td></tr>
                    <tr><td style="padding:10px;">Shell</td><td>Fuel</td><td>$45.50</td><td style="color:var(--accent-color);">3.20 kg</td></tr>
                    <tr><td style="padding:10px;">Whole Foods</td><td>Groceries</td><td>$124.30</td><td style="color:var(--primary-color);">2.50 kg</td></tr>
                </table>
            </div>
        </section>

        <!-- 3. PAY BILLS -->
        <section id="pay-bills" class="section">
            <div class="bills-layout">
                <!-- Payment Form -->
                <div class="card">
                    <h3 style="margin-bottom: 1.5rem;"><i class="fa-regular fa-credit-card"></i> Pay a Bill</h3>
                    <form onsubmit="handlePayment(event)">
                        <div class="bill-form-group">
                            <label>Select Biller</label>
                            <select class="bill-input">
                                <option>City Electric Co.</option>
                                <option>Gas Utility Provider</option>
                                <option>Water & Sewage</option>
                                <option>Internet Provider</option>
                            </select>
                        </div>
                        <div class="bill-form-group">
                            <label>Account Number</label>
                            <input type="text" class="bill-input" placeholder="e.g. 1234-5678" required>
                        </div>
                        <div class="bill-form-group">
                            <label>Amount ($)</label>
                            <input type="number" class="bill-input" placeholder="0.00" required>
                        </div>
                        <div class="bill-form-group">
                            <label>Payment Method</label>
                            <select class="bill-input">
                                <option>Visa ending in 4242</option>
                                <option>Bank Account ****8832</option>
                            </select>
                        </div>
                        <button type="submit" class="pay-btn">
                            Pay Now <i class="fa-solid fa-arrow-right"></i>
                        </button>
                    </form>
                </div>

                <!-- Upcoming Bills -->
                <div class="card">
                    <h3 style="margin-bottom: 1.5rem;">Upcoming Bills</h3>
                    <div class="bill-item">
                        <div>
                            <div style="font-weight:600;">City Electric Co.</div>
                            <div style="font-size:0.8rem; color:var(--text-secondary);">Due Jan 15</div>
                        </div>
                        <div style="text-align:right;">
                            <div style="font-weight:700;">$85.00</div>
                            <span style="font-size:0.7rem; background:#ecfdf5; color:var(--primary-dark); padding:2px 6px; border-radius:4px;">Low Impact</span>
                        </div>
                    </div>
                    <div class="bill-item">
                        <div>
                            <div style="font-weight:600;">Gas Utility</div>
                            <div style="font-size:0.8rem; color:var(--text-secondary);">Due Jan 18</div>
                        </div>
                        <div style="text-align:right;">
                            <div style="font-weight:700;">$42.50</div>
                            <span style="font-size:0.7rem; background:#fffbeb; color:var(--accent-color); padding:2px 6px; border-radius:4px;">Med Impact</span>
                        </div>
                    </div>
                    <div class="bill-item">
                        <div>
                            <div style="font-weight:600;">High Speed Internet</div>
                            <div style="font-size:0.8rem; color:var(--text-secondary);">Due Jan 22</div>
                        </div>
                        <div style="text-align:right;">
                            <div style="font-weight:700;">$60.00</div>
                            <span style="font-size:0.7rem; background:#ecfdf5; color:var(--primary-dark); padding:2px 6px; border-radius:4px;">Low Impact</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. INSIGHTS -->
        <section id="insights" class="section">
            <div class="card impact-card" style="text-align: center;">
                <h3>Your Environmental Impact</h3>
                <div style="font-size: 3rem; margin: 1rem 0; color: var(--primary-color);">11 Trees</div>
                <p>Needed to offset your annual emissions.</p>
            </div>
        </section>

        <!-- 5. RECOMMENDATIONS -->
        <section id="recommendations" class="section">
            <div class="card">
                <h3>Energy Efficiency Opportunity</h3>
                <p style="color:var(--text-secondary); margin: 10px 0;">Switch to renewable energy provider.</p>
                <div style="margin-top: 10px; font-weight: bold; color: var(--primary-color);">Save 0.10 kg CO₂e</div>
            </div>
        </section>

        <!-- 6. SETTINGS: YOUR INFO -->
        <section id="settings-info" class="section">
            <div class="card">
                <h3>Your Info</h3>
                <div class="settings-grid">
                    <div class="bill-form-group">
                        <label>Full Name</label>
                        <input type="text" class="bill-input" value="Alex Johnson">
                    </div>
                    <div class="bill-form-group">
                        <label>Email</label>
                        <input type="email" class="bill-input" value="alex.j@example.com">
                    </div>
                    <div class="bill-form-group">
                        <label>Phone</label>
                        <input type="tel" class="bill-input" value="+1 (555) 123-4567">
                    </div>
                    <div class="bill-form-group">
                        <label>Location</label>
                        <input type="text" class="bill-input" value="San Francisco, CA">
                    </div>
                </div>
                <button class="pay-btn" style="width: auto; padding: 10px 30px;">Save Changes</button>
            </div>
        </section>

        <!-- 7. SETTINGS: NOTIFICATIONS -->
        <section id="settings-notifications" class="section">
            <div class="card">
                <h3>Notifications</h3>
                <div class="setting-item">
                    <div>
                        <div style="font-weight: 600;">Weekly Carbon Report</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Receive a summary every Sunday.</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div>
                        <div style="font-weight: 600;">High Spending Alerts</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Alert when spending exceeds $200.</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div>
                        <div style="font-weight: 600;">New Tips & Recommendations</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Get notified about new ways to save.</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </section>

        <!-- 8. SETTINGS: PRIVACY & SECURITY -->
        <section id="settings-privacy" class="section">
            <div class="card">
                <h3>Privacy & Security</h3>
                <div class="setting-item">
                    <div>
                        <div style="font-weight: 600;">Two-Factor Authentication</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Add an extra layer of security.</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div>
                        <div style="font-weight: 600;">Public Profile</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">Allow others to see your eco-badge.</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div style="margin-top: 20px;">
                    <button class="pay-btn" style="background-color: var(--bg-body); color: var(--text-main); border: 1px solid var(--border-color);">Change Password</button>
                </div>
            </div>
        </section>

        <!-- 9. SETTINGS: ABOUT -->
        <section id="settings-about" class="section">
            <div class="card">
                <h3>About EcoTrack</h3>
                <p style="margin-bottom: 1rem; color: var(--text-secondary);">Version 1.0.0</p>
                <p>EcoTrack helps you monitor your carbon footprint based on your daily transactions and provides actionable insights to live a more sustainable life.</p>
                <div style="margin-top: 20px;">
                    <a href="#" style="color: var(--primary-color); text-decoration: none;">Terms of Service</a> | 
                    <a href="#" style="color: var(--primary-color); text-decoration: none;">Privacy Policy</a>
                </div>
            </div>
        </section>

        <!-- 10. SETTINGS: HELP & FEEDBACK -->
        <section id="settings-help" class="section">
            <div class="card">
                <h3>Help & Feedback</h3>
                <div class="bill-form-group">
                    <label>How can we help?</label>
                    <select class="bill-input">
                        <option>Report a Bug</option>
                        <option>Feature Request</option>
                        <option>General Inquiry</option>
                    </select>
                </div>
                <div class="bill-form-group">
                    <label>Message</label>
                    <textarea class="bill-input" rows="5" placeholder="Type your message here..."></textarea>
                </div>
                <button class="pay-btn">Submit Feedback</button>
            </div>
        </section>

    </main>

    <!-- Chatbot Widget -->
    <div class="chat-toggle-btn" onclick="toggleChat()">
        <i class="fa-solid fa-comments"></i>
    </div>

    <div class="chat-container" id="chat-window">
        <div class="chat-header">
            <span><i class="fa-solid fa-robot"></i> EcoBot</span>
            <i class="fa-solid fa-xmark" style="cursor: pointer;" onclick="toggleChat()"></i>
        </div>
        <div class="chat-body" id="chat-messages">
            <div class="chat-msg bot">Hi Alex! I'm EcoBot. How can I help you reduce your carbon footprint today?</div>
        </div>
        <div class="chat-input-area">
            <input type="text" class="chat-input" id="chat-input" placeholder="Type a message..." onkeypress="handleChatKey(event)">
            <button onclick="sendChatMessage()" style="background:none; border:none; color:var(--primary-color); cursor:pointer;">
                <i class="fa-solid fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        // --- Navigation Logic ---
        function switchTab(tabId) {
            // Update visual active state in sidebar (excluding sign out)
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            // Find the menu item that matches the tabId
            const activeLink = Array.from(document.querySelectorAll('.nav-item')).find(el => el.getAttribute('onclick')?.includes(tabId));
            if(activeLink) activeLink.classList.add('active');

            // Switch content
            document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
            const target = document.getElementById(tabId);
            if (target) {
                target.classList.add('active');
                
                // Update Header Text based on ID
                const titles = {
                    'dashboard': 'Dashboard',
                    'transactions': 'Transactions',
                    'pay-bills': 'Pay Bills',
                    'insights': 'Insights',
                    'recommendations': 'Recommendations',
                    'settings-info': 'Your Info',
                    'settings-notifications': 'Notifications',
                    'settings-privacy': 'Privacy & Security',
                    'settings-about': 'About',
                    'settings-help': 'Help & Feedback'
                };
                document.getElementById('page-header').innerText = titles[tabId] || 'Dashboard';
            }

            // Close sidebar on mobile
            if(window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('open');
            }
        }

        // --- Settings Submenu Logic ---
        function toggleSettingsMenu() {
            const menu = document.getElementById('settings-submenu');
            const arrow = document.getElementById('settings-arrow');
            menu.classList.toggle('open');
            
            // Rotate arrow
            if(menu.classList.contains('open')) {
                arrow.style.transform = "rotate(180deg)";
            } else {
                arrow.style.transform = "rotate(0deg)";
            }
        }

        // --- Mobile Sidebar Toggle ---
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // --- Pay Bills Logic ---
        function handlePayment(e) {
            e.preventDefault();
            const btn = e.target.querySelector('.pay-btn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Processing...';
            
            setTimeout(() => {
                btn.innerHTML = '<i class="fa-solid fa-check"></i> Paid!';
                btn.style.backgroundColor = 'var(--primary-dark)';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.backgroundColor = '';
                    e.target.reset();
                }, 2000);
            }, 1500);
        }

        // --- Chatbot Logic ---
        function toggleChat() {
            document.getElementById('chat-window').classList.toggle('open');
            if(document.getElementById('chat-window').classList.contains('open')) {
                document.getElementById('chat-input').focus();
            }
        }

        function handleChatKey(e) {
            if (e.key === 'Enter') sendChatMessage();
        }

        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const msg = input.value.trim();
            if (!msg) return;

            const chatBody = document.getElementById('chat-messages');

            // Add User Message
            const userDiv = document.createElement('div');
            userDiv.className = 'chat-msg user';
            userDiv.innerText = msg;
            chatBody.appendChild(userDiv);

            input.value = '';
            chatBody.scrollTop = chatBody.scrollHeight;

            // Simulate Bot Response
            setTimeout(() => {
                const botDiv = document.createElement('div');
                botDiv.className = 'chat-msg bot';
                
                // Simple response logic
                if(msg.toLowerCase().includes('bill')) {
                    botDiv.innerText = "You can pay your upcoming bills in the 'Pay Bills' section. Your next bill is due on Jan 15.";
                } else if (msg.toLowerCase().includes('carbon') || msg.toLowerCase().includes('emission')) {
                    botDiv.innerText = "Your current monthly emission is 204.26 kg. To reduce this, try using public transport or switching to renewable energy.";
                } else {
                    botDiv.innerText = "I can help with bills, carbon tracking tips, or account settings. What would you like to know?";
                }
                
                chatBody.appendChild(botDiv);
                chatBody.scrollTop = chatBody.scrollHeight;
            }, 1000);
        }
    </script>
</body>
</html>
